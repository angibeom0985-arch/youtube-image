<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì í˜ì´ì§€</title>
    <!-- Tailwind CSS ì¶”ê°€ (ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì™€ ë™ì¼í•œ ìŠ¤íƒ€ì¼ë§) -->
    <script>
        // Tailwind CDN production ê²½ê³  ì–µì œ
        window.process = { env: { NODE_ENV: 'development' } };
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .login-form {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
        }

        .login-form h1 {
            text-align: center;
            margin-bottom: 2rem;
            color: #333;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .login-btn:hover {
            transform: translateY(-1px);
        }

        .error-message {
            color: #e74c3c;
            text-align: center;
            margin-top: 1rem;
            display: none;
        }

        /* Admin Panel Styles */
        .admin-panel {
            display: none;
            padding: 2rem;
            background: white;
            min-height: 100vh;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e1e5e9;
        }

        .admin-header h1 {
            color: #333;
            font-weight: 600;
        }

        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: #c0392b;
        }

        .editor-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
        }

        .editor-controls {
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: center;
            flex-wrap: wrap;
            padding: 1.5rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border-bottom: 3px solid #667eea;
        }

        .page-selector {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .page-selector label {
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        .page-select {
            padding: 0.5rem;
            border: 2px solid #e1e5e9;
            border-radius: 5px;
            background: white;
            font-size: 0.9rem;
            min-width: 200px;
            cursor: pointer;
        }

        .page-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .mode-selector {
            display: flex;
            gap: 0.5rem;
        }

        .mode-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .editor-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .preview-btn {
            background: #28a745;
            color: white;
        }

        .preview-btn:hover {
            background: #218838;
        }

        .save-btn {
            background: #007bff !important;
            color: white !important;
            cursor: pointer !important;
            opacity: 1 !important;
        }

        .save-btn:hover {
            background: #0056b3 !important;
        }

        .action-btn:disabled:not(.save-btn) {
            background: #6c757d;
            color: #adb5bd;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* ì €ì¥ ë²„íŠ¼ì€ í•­ìƒ í™œì„±í™” */
        #saveBtn[disabled] {
            background: #007bff !important;
            color: white !important;
            cursor: pointer !important;
            opacity: 1 !important;
        }

        .image-btn {
            background: #17a2b8;
            color: white;
        }

        .image-btn:hover {
            background: #138496;
        }

        .editor-textarea {
            width: 100%;
            min-height: 500px;
            padding: 1rem;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 15px;
            line-height: 1.6;
            resize: vertical;
            outline: none;
            transition: border-color 0.3s;
            background: #ffffff;
            color: #333333;
        }

        .editor-textarea:focus {
            border-color: #667eea;
        }

        /* HTML ëª¨ë“œ ìŠ¤íƒ€ì¼ë§ */
        .html-mode .editor-textarea {
            display: block;
            background: #1e1e1e;
            color: #d4d4d4;
            border-color: #404040;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            tab-size: 4;
            -moz-tab-size: 4;
            -o-tab-size: 4;
        }

        .html-mode .html-preview {
            display: none !important;
        }

        .html-mode .editor-textarea::selection {
            background: #264f78;
        }

        .html-mode .editor-textarea::-moz-selection {
            background: #264f78;
        }

        /* HTML ë¬¸ë²• í•˜ì´ë¼ì´íŒ…ì„ ìœ„í•œ ìŠ¤íƒ€ì¼ */
        .code-highlight {
            position: relative;
        }

        .syntax-html-tag { color: #569cd6; }
        .syntax-attribute { color: #92c5f8; }
        .syntax-string { color: #ce9178; }
        .syntax-comment { color: #6a9955; }
        .syntax-doctype { color: #808080; }
        .syntax-text { color: #d4d4d4; }

        /* ê¸°ë³¸ëª¨ë“œëŠ” í¸ì§‘ ê°€ëŠ¥í•œ WYSIWYG ì—ë””í„°ë¡œ */
        .basic-mode .editor-textarea {
            display: none;
        }

        .basic-mode .html-preview {
            display: block !important;
            width: 100%;
            min-height: 500px;
            padding: 2rem;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            background: #f8fafc; /* ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì™€ ë™ì¼í•œ ë°ì€ ë°°ê²½ */
            color: #1a202c; /* ì–´ë‘ìš´ í…ìŠ¤íŠ¸ */
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            overflow-y: auto;
            /* í¸ì§‘ ê°€ëŠ¥í•œ ìŠ¤íƒ€ì¼ */
            outline: none;
            cursor: text;
        }

        .basic-mode .html-preview:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .basic-mode .html-preview:empty:before {
            content: "ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì—¬ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...";
            color: #9ca3af;
            pointer-events: none;
        }

        /* Tailwind CSS ìŠ¤íƒ€ì¼ ì ìš© - ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì™€ ë™ì¼ */
        .html-preview h1 {
            font-size: 2.25rem;
            font-weight: 700;
            margin: 1.5rem 0 1rem 0;
            color: #1f2937;
            line-height: 1.2;
            text-align: center;
        }

        .html-preview h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem 0;
            color: #1f2937;
        }

        .html-preview h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
            color: #1f2937;
        }

        .html-preview p {
            margin: 0.75rem 0;
            color: #374151;
            line-height: 1.7;
        }

        .html-preview img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 1rem 0;
            cursor: pointer;
        }

        .html-preview img:hover {
            transform: scale(1.02);
            transition: transform 0.2s ease;
        }

        .html-preview .bg-blue-50 {
            background: #eff6ff;
            border: 1px solid #dbeafe;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .html-preview .bg-amber-50 {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            border-radius: 0 8px 8px 0;
            margin: 1rem 0;
        }

        .html-preview .text-blue-800 {
            color: #1e40af;
        }

        .html-preview .text-amber-800 {
            color: #92400e;
        }

        .html-preview .text-amber-700 {
            color: #b45309;
        }

        .html-preview .bg-gray-900 {
            background: #111827;
            color: #10b981;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.875rem;
            margin: 1rem 0;
        }

        .html-preview .bg-white {
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3b82f6;
            margin: 2rem 0;
        }

        .html-preview .step-number {
            background: #3b82f6;
            color: white;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 1rem;
        }

        .html-preview h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
            color: #e2e8f0;
        }

        .html-preview p {
            margin: 1rem 0;
            color: #cbd5e0;
            line-height: 1.7;
        }

        .html-preview a {
            color: #63b3ed;
            text-decoration: none;
            transition: color 0.2s;
        }

        .html-preview a:hover {
            color: #90cdf4;
            text-decoration: underline;
        }

        .html-preview ul, .html-preview ol {
            margin: 1rem 0;
            padding-left: 2rem;
            color: #cbd5e0;
        }

        .html-preview li {
            margin: 0.5rem 0;
        }

        .html-preview img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .html-preview blockquote {
            border-left: 4px solid #4a5568;
            padding-left: 1rem;
            margin: 1rem 0;
            color: #a0aec0;
            font-style: italic;
        }

        .html-preview code {
            background: #2d3748;
            color: #f56565;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: ui-monospace, SFMono-Regular, "SF Mono", Monaco, Consolas, monospace;
            font-size: 0.875rem;
        }

        .html-preview pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: ui-monospace, SFMono-Regular, "SF Mono", Monaco, Consolas, monospace;
        }

        .html-preview pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        /* Tailwind ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë“¤ */
        .html-preview .text-blue-400 { color: #63b3ed; }
        .html-preview .text-green-400 { color: #68d391; }
        .html-preview .text-red-400 { color: #fc8181; }
        .html-preview .text-yellow-400 { color: #f6e05e; }
        .html-preview .text-purple-400 { color: #b794f6; }
        .html-preview .text-gray-400 { color: #a0aec0; }
        
        .html-preview .bg-gray-800 { background-color: #2d3748; padding: 1rem; border-radius: 8px; }
        .html-preview .bg-blue-900 { background-color: #2a4365; padding: 1rem; border-radius: 8px; }
        
        .html-preview .border { border: 1px solid #4a5568; }
        .html-preview .border-l { border-left: 4px solid #4a5568; }
        
        .html-preview .rounded { border-radius: 8px; }
        .html-preview .p-4 { padding: 1rem; }
        .html-preview .m-4 { margin: 1rem; }
        
        .html-preview .font-bold { font-weight: 700; }
        .html-preview .font-semibold { font-weight: 600; }
        .html-preview .text-lg { font-size: 1.125rem; }
        .html-preview .text-xl { font-size: 1.25rem; }
        .html-preview .text-2xl { font-size: 1.5rem; }

        /* ìƒíƒœ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */

        .image-upload {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .image-upload-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
        }

        .image-upload h3 {
            margin-bottom: 1rem;
            color: #333;
        }

        .image-upload input[type="file"] {
            width: 100%;
            margin-bottom: 1rem;
        }

        .image-upload-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .close-btn {
            background: #6c757d;
            color: white;
        }

        .close-btn:hover {
            background: #545b62;
        }

        .insert-btn {
            background: #28a745;
            color: white;
        }

        .insert-btn:hover {
            background: #218838;
        }

        .status-message {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 5px;
            text-align: center;
            display: none;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-loading {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        /* ì„±ê³µ ì•Œë¦¼ ëª¨ë‹¬ */
        .success-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .success-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .success-modal-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            transform: scale(0.7);
            transition: transform 0.3s ease;
        }

        .success-modal.show .success-modal-content {
            transform: scale(1);
        }

        .success-icon {
            font-size: 3rem;
            color: #28a745;
            margin-bottom: 1rem;
        }

        .success-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .success-message {
            color: #666;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .success-ok-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s;
        }

        .success-ok-btn:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="loginContainer" class="login-container">
        <form id="loginForm" class="login-form">
            <h1>ê´€ë¦¬ì ë¡œê·¸ì¸</h1>
            <div class="form-group">
                <label for="username">ì•„ì´ë””</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit" class="login-btn">ë¡œê·¸ì¸</button>
            <div id="errorMessage" class="error-message">ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
        </form>
    </div>

    <!-- ê´€ë¦¬ì íŒ¨ë„ -->
    <div id="adminPanel" class="admin-panel">
        <header class="admin-header">
            <h1>ê´€ë¦¬ì íŒ¨ë„ - ê¸€ í¸ì§‘</h1>
            <button id="logoutBtn" class="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
        </header>

        <div class="editor-container">
            <div class="editor-controls">
                <div class="page-selector">
                    <label for="pageSelect">ìˆ˜ì •í•  í˜ì´ì§€:</label>
                    <select id="pageSelect" class="page-select">
                        <option value="">í˜ì´ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="API í‚¤ ë°œê¸‰ ê°€ì´ë“œ">API í‚¤ ë°œê¸‰ ê°€ì´ë“œ</option>
                        <option value="ì‚¬ìš©ë²• ê°€ì´ë“œ">ì‚¬ìš©ë²• ê°€ì´ë“œ</option>
                    </select>
                </div>
                
                <div class="mode-selector">
                    <button id="basicModeBtn" class="mode-btn active">ê¸°ë³¸ëª¨ë“œ</button>
                    <button id="htmlModeBtn" class="mode-btn">HTMLëª¨ë“œ</button>
                </div>
                
                <div class="editor-actions">
                    <button id="imageBtn" class="action-btn image-btn">ì´ë¯¸ì§€ ì²¨ë¶€</button>
                    <button id="previewBtn" class="action-btn preview-btn">ë¯¸ë¦¬ë³´ê¸°</button>
                    <button id="saveBtn" class="action-btn save-btn" disabled>ì €ì¥í•˜ê¸°</button>
                </div>
            </div>

            <div class="code-container">
                <!-- ê¸°ë³¸ëª¨ë“œ: HTML ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ -->
                <div id="htmlPreview" class="html-preview" style="display: none;"></div>
                <!-- HTMLëª¨ë“œ: ì½”ë“œ ì—ë””í„° -->
                <textarea id="contentEditor" class="editor-textarea" placeholder="ì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
            </div>
            
            <div id="statusMessage" class="status-message"></div>
        </div>
    </div>

    <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ ëª¨ë‹¬ -->
    <div id="imageUpload" class="image-upload">
        <div class="image-upload-content">
            <h3>ì´ë¯¸ì§€ ì²¨ë¶€</h3>
            <input type="file" id="imageFile" accept="image/*">
            <div class="image-upload-actions">
                <button id="closeImageBtn" class="action-btn close-btn">ì·¨ì†Œ</button>
                <button id="insertImageBtn" class="action-btn insert-btn">ì‚½ì…</button>
            </div>
        </div>
    </div>

    <!-- ì„±ê³µ ì•Œë¦¼ ëª¨ë‹¬ -->
    <div id="successModal" class="success-modal">
        <div class="success-modal-content">
            <div class="success-icon">âœ…</div>
            <div class="success-title">ì €ì¥ ì™„ë£Œ!</div>
            <div class="success-message" id="successMessage">
                í˜ì´ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
            </div>
            <button id="successOkBtn" class="success-ok-btn">í™•ì¸</button>
        </div>
    </div>

    <script>
        // API ë² ì´ìŠ¤ URL ì„¤ì • (ë¡œì»¬ê³¼ ë°°í¬ í™˜ê²½ ìë™ ê°ì§€)
        const API_BASE_URL = window.location.hostname === 'localhost' 
            ? 'http://localhost:3003' 
            : '';  // ë°°í¬ í™˜ê²½ì—ì„œëŠ” ìƒëŒ€ ê²½ë¡œ ì‚¬ìš© (Vercel Functions)
        
        console.log('API Base URL:', API_BASE_URL);
        console.log('Current hostname:', window.location.hostname);
        
        // ì „ì—­ ë³€ìˆ˜
        let currentMode = 'basic';
        let isLoggedIn = false;
        let currentPage = '';
        
        // DOM ìš”ì†Œ
        const loginContainer = document.getElementById('loginContainer');
        const adminPanel = document.getElementById('adminPanel');
        const loginForm = document.getElementById('loginForm');
        const errorMessage = document.getElementById('errorMessage');
        const logoutBtn = document.getElementById('logoutBtn');
        const contentEditor = document.getElementById('contentEditor');
        const htmlPreview = document.getElementById('htmlPreview');
        const pageSelect = document.getElementById('pageSelect');
        const basicModeBtn = document.getElementById('basicModeBtn');
        const htmlModeBtn = document.getElementById('htmlModeBtn');
        const imageBtn = document.getElementById('imageBtn');
        const previewBtn = document.getElementById('previewBtn');
        const saveBtn = document.getElementById('saveBtn');
        const statusMessage = document.getElementById('statusMessage');
        const imageUpload = document.getElementById('imageUpload');
        const closeImageBtn = document.getElementById('closeImageBtn');
        const insertImageBtn = document.getElementById('insertImageBtn');
        const imageFile = document.getElementById('imageFile');
        
        // ì„±ê³µ ëª¨ë‹¬ ìš”ì†Œ
        const successModal = document.getElementById('successModal');
        const successMessage = document.getElementById('successMessage');
        const successOkBtn = document.getElementById('successOkBtn');

        // ë¡œê·¸ì¸ ê¸°ëŠ¥
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // ì¸ì¦ í™•ì¸
            if (username === 'akb0811' && password === 'rlqja0985!') {
                isLoggedIn = true;
                sessionStorage.setItem('adminLoggedIn', 'true');
                showAdminPanel();
            } else {
                showError('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥
        logoutBtn.addEventListener('click', function() {
            isLoggedIn = false;
            sessionStorage.removeItem('adminLoggedIn');
            showLoginForm();
        });

        // í˜ì´ì§€ ì„ íƒ ë° ë¡œë“œ ê¸°ëŠ¥
        pageSelect.addEventListener('change', async function() {
            const selectedPage = this.value;
            console.log('í˜ì´ì§€ ì„ íƒë¨:', selectedPage); // ë””ë²„ê¹…ìš©
            
            if (selectedPage) {
                currentPage = selectedPage;
                
                // ì €ì¥ ë²„íŠ¼ ì¦‰ì‹œ í™œì„±í™”
                if (saveBtn) {
                    saveBtn.disabled = false;
                    console.log('ì €ì¥ ë²„íŠ¼ í™œì„±í™”ë¨'); // ë””ë²„ê¹…ìš©
                }
                
                await loadPageContent(selectedPage);
                
                // í˜„ì¬ í˜ì´ì§€ ì €ì¥
                localStorage.setItem('adminCurrentPage', selectedPage);
            }
        });

        // ì´ í•¨ìˆ˜ëŠ” ìœ„ì—ì„œ ìƒˆë¡œ ì •ì˜ëœ async loadPageContentë¡œ ëŒ€ì²´ë¨

        // í™”ë©´ ì „í™˜ í•¨ìˆ˜
        function showAdminPanel() {
            loginContainer.style.display = 'none';
            adminPanel.style.display = 'block';
            errorMessage.style.display = 'none';
            
            // ì €ì¥ ë²„íŠ¼ ê°•ì œ í™œì„±í™”
            if (saveBtn) {
                saveBtn.disabled = false;
                saveBtn.textContent = 'ğŸ’¾ ì €ì¥';
                console.log('Admin íŒ¨ë„ í‘œì‹œ - ì €ì¥ ë²„íŠ¼ í™œì„±í™”ë¨');
            }
            
            // ê¸°ë³¸ í˜ì´ì§€ ì„ íƒ ë° ë¡œë“œ
            if (pageSelect) {
                pageSelect.value = 'API í‚¤ ë°œê¸‰ ê°€ì´ë“œ';
                currentPage = 'API í‚¤ ë°œê¸‰ ê°€ì´ë“œ';
                console.log('ê¸°ë³¸ í˜ì´ì§€ ì„¤ì •:', currentPage);
                
                // í˜ì´ì§€ ë‚´ìš© ë¡œë“œ
                setTimeout(() => {
                    loadPageContent(currentPage);
                }, 300);
            }
            
            loadSavedContent();
        }

        function showLoginForm() {
            loginContainer.style.display = 'flex';
            adminPanel.style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }

        // ëª¨ë“œ ì „í™˜ ê¸°ëŠ¥
        basicModeBtn.addEventListener('click', function() {
            switchMode('basic');
        });

        htmlModeBtn.addEventListener('click', function() {
            switchMode('html');
        });

        function switchMode(mode) {
            currentMode = mode;
            
            // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            basicModeBtn.classList.toggle('active', mode === 'basic');
            htmlModeBtn.classList.toggle('active', mode === 'html');
            
            // ì—ë””í„° ì»¨í…Œì´ë„ˆì— ëª¨ë“œ í´ë˜ìŠ¤ ì ìš©
            const editorContainer = document.querySelector('.editor-container');
            editorContainer.classList.remove('basic-mode', 'html-mode');
            editorContainer.classList.add(`${mode}-mode`);
            
            // bodyì—ë„ í´ë˜ìŠ¤ ì ìš© (ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•´)
            document.body.classList.toggle('html-mode', mode === 'html');
            document.body.classList.toggle('basic-mode', mode === 'basic');
            
            if (mode === 'basic') {
                // ê¸°ë³¸ëª¨ë“œ: WYSIWYG í¸ì§‘ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
                htmlPreview.contentEditable = true;
                htmlPreview.setAttribute('data-placeholder', 'ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì—¬ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...');
                
                // HTML ë¯¸ë¦¬ë³´ê¸°ë¥¼ í˜„ì¬ textarea ë‚´ìš©ìœ¼ë¡œ ì—…ë°ì´íŠ¸
                updateHtmlPreview();
                
                // ê¸°ë³¸ëª¨ë“œì—ì„œ í¸ì§‘ ì‹œ textareaì™€ ë™ê¸°í™”
                htmlPreview.addEventListener('input', syncPreviewToTextarea);
                htmlPreview.addEventListener('paste', handlePasteInPreview);
                
                // ë“œë˜ê·¸ì•¤ë“œë¡­ ì´ë²¤íŠ¸ ì¶”ê°€
                htmlPreview.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    htmlPreview.style.borderColor = '#667eea';
                    htmlPreview.style.backgroundColor = '#f0f4ff';
                });
                
                htmlPreview.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    htmlPreview.style.borderColor = '#e1e5e9';
                    htmlPreview.style.backgroundColor = '#f8fafc';
                });
                
                htmlPreview.addEventListener('drop', (e) => {
                    e.preventDefault();
                    htmlPreview.style.borderColor = '#e1e5e9';
                    htmlPreview.style.backgroundColor = '#f8fafc';
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0 && files[0].type.startsWith('image/')) {
                        handleImageUpload(files[0]);
                    }
                });
                
                // textarea ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ (ì™¸ë¶€ì—ì„œ ë¡œë“œí•  ë•Œ)
                contentEditor.addEventListener('input', function() {
                    updateHtmlPreview();
                    // ë‚´ìš©ì´ ë³€ê²½ë˜ë©´ ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                    if (currentPage) {
                        saveBtn.disabled = false;
                    }
                });
            } else {
                // HTMLëª¨ë“œ: í¸ì§‘ ë¶ˆê°€ëŠ¥í•˜ê²Œ ì„¤ì •
                htmlPreview.contentEditable = false;
                
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
                htmlPreview.removeEventListener('input', syncPreviewToTextarea);
                htmlPreview.removeEventListener('paste', handlePasteInPreview);
                contentEditor.removeEventListener('input', updateHtmlPreview);
                
                // HTML ë¬¸ë²• í•˜ì´ë¼ì´íŒ… ì ìš©
                applyCodeHighlighting();
                contentEditor.addEventListener('input', applyCodeHighlighting);
            }
            
            showStatusMessage('success', `${mode === 'basic' ? 'ê¸°ë³¸' : 'HTML'}ëª¨ë“œë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // HTML ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateHtmlPreview() {
            if (currentMode === 'basic') {
                const htmlContent = contentEditor.value || '<div class="p-4"><p class="text-gray-400">ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...</p></div>';
                
                // Tailwind í´ë˜ìŠ¤ê°€ ì ìš©ë˜ì§€ ì•Šì€ HTMLì„ ìë™ìœ¼ë¡œ ìŠ¤íƒ€ì¼ë§
                let processedContent = htmlContent;
                
                // ê¸°ë³¸ íƒœê·¸ë“¤ì— Tailwind í´ë˜ìŠ¤ ìë™ ì¶”ê°€
                processedContent = processedContent.replace(/<h1(?![^>]*class)/g, '<h1 class="text-3xl font-bold text-white mb-4"');
                processedContent = processedContent.replace(/<h2(?![^>]*class)/g, '<h2 class="text-2xl font-semibold text-gray-200 mb-3"');
                processedContent = processedContent.replace(/<h3(?![^>]*class)/g, '<h3 class="text-xl font-semibold text-gray-300 mb-2"');
                processedContent = processedContent.replace(/<p(?![^>]*class)/g, '<p class="text-gray-300 mb-4 leading-relaxed"');
                processedContent = processedContent.replace(/<a(?![^>]*class)/g, '<a class="text-blue-400 hover:text-blue-300 underline"');
                processedContent = processedContent.replace(/<ul(?![^>]*class)/g, '<ul class="list-disc list-inside text-gray-300 mb-4 space-y-2"');
                processedContent = processedContent.replace(/<ol(?![^>]*class)/g, '<ol class="list-decimal list-inside text-gray-300 mb-4 space-y-2"');
                processedContent = processedContent.replace(/<li(?![^>]*class)/g, '<li class="text-gray-300"');
                processedContent = processedContent.replace(/<blockquote(?![^>]*class)/g, '<blockquote class="border-l-4 border-gray-600 pl-4 text-gray-400 italic"');
                processedContent = processedContent.replace(/<code(?![^>]*class)/g, '<code class="bg-gray-800 text-red-400 px-2 py-1 rounded text-sm font-mono"');
                processedContent = processedContent.replace(/<pre(?![^>]*class)/g, '<pre class="bg-gray-800 text-gray-200 p-4 rounded-lg overflow-x-auto mb-4"');
                
                htmlPreview.innerHTML = processedContent;
            }
        }

        // ê°„ë‹¨í•œ HTML ë¬¸ë²• í•˜ì´ë¼ì´íŒ…
        function applyCodeHighlighting() {
            if (currentMode !== 'html') return;
            
            // ê¸°ë³¸ì ì¸ ë‹¤í¬í…Œë§ˆ ì ìš© (ì‹¤ì œ ë¬¸ë²• í•˜ì´ë¼ì´íŒ…ì€ ë³µì¡í•˜ë¯€ë¡œ CSSë§Œ ì ìš©)
            const textarea = contentEditor;
            textarea.style.background = '#1e1e1e';
            textarea.style.color = '#d4d4d4';
            textarea.style.border = '2px solid #404040';
        }

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬ í•¨ìˆ˜
        async function handleImageUpload(file) {
            if (!file || !file.type.startsWith('image/')) {
                showStatusMessage('error', 'ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            const maxSize = 5 * 1024 * 1024; // 5MB
            if (file.size > maxSize) {
                showStatusMessage('error', 'ì´ë¯¸ì§€ í¬ê¸°ëŠ” 5MB ì´í•˜ë¡œ ì œí•œë©ë‹ˆë‹¤.');
                return;
            }

            try {
                // íŒŒì¼ì„ base64ë¡œ ë³€í™˜
                const reader = new FileReader();
                reader.onload = async function(e) {
                    const base64Data = e.target.result;
                    const filename = `uploaded_${Date.now()}_${file.name}`;
                    
                    try {
                        // ì„œë²„ì— ì´ë¯¸ì§€ ì—…ë¡œë“œ
                        const response = await fetch(`${API_BASE_URL}/api/upload-image`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                filename: filename,
                                data: base64Data
                            })
                        });

                        const result = await response.json();
                        
                        if (result.success) {
                            // ì´ë¯¸ì§€ë¥¼ ì—ë””í„°ì— ì‚½ì…
                            insertImageToEditor(result.path, filename);
                            showStatusMessage('success', 'ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                        } else {
                            throw new Error(result.error);
                        }
                    } catch (uploadError) {
                        console.error('ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨:', uploadError);
                        // ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ ì´ë¯¸ì§€ë¡œ í‘œì‹œ
                        insertImageToEditor(base64Data, filename);
                        showStatusMessage('warning', 'ì„œë²„ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆì§€ë§Œ ë¡œì»¬ì—ì„œ í‘œì‹œë©ë‹ˆë‹¤.');
                    }
                };
                reader.readAsDataURL(file);
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                showStatusMessage('error', 'ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì—ë””í„°ì— ì´ë¯¸ì§€ ì‚½ì…
        function insertImageToEditor(imageSrc, altText) {
            const imgHtml = `<img src="${imageSrc}" alt="${altText}" class="w-full rounded-lg shadow-md my-4" style="max-width: 100%; height: auto;">`;
            
            if (currentMode === 'basic') {
                // ê¸°ë³¸ëª¨ë“œ: contenteditable ì˜ì—­ì— ì‹¤ì œ ì´ë¯¸ì§€ ìš”ì†Œë¡œ ì‚½ì…
                const selection = window.getSelection();
                
                // ì‹¤ì œ img DOM ìš”ì†Œ ìƒì„±
                const imgElement = document.createElement('img');
                imgElement.src = imageSrc;
                imgElement.alt = altText;
                imgElement.className = 'w-full rounded-lg shadow-md my-4';
                imgElement.style.maxWidth = '100%';
                imgElement.style.height = 'auto';
                
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    range.deleteContents();
                    
                    // ì´ë¯¸ì§€ë¥¼ ê°ì‹¸ëŠ” div ìƒì„± (ë¸”ë¡ ë ˆë²¨ ìš”ì†Œë¡œ ë§Œë“¤ê¸°)
                    const wrapper = document.createElement('div');
                    wrapper.className = 'my-4';
                    wrapper.appendChild(imgElement);
                    range.insertNode(wrapper);
                    
                    // ì»¤ì„œë¥¼ ì´ë¯¸ì§€ ë’¤ë¡œ ì´ë™ (try-catchë¡œ ì˜¤ë¥˜ ë°©ì§€)
                    try {
                        range.setStartAfter(wrapper);
                        range.collapse(true);
                        selection.removeAllRanges();
                        selection.addRange(range);
                    } catch (e) {
                        console.log('ì»¤ì„œ ìœ„ì¹˜ ì„¤ì • ì˜¤ë¥˜ (ë¬´ì‹œë¨):', e);
                    }
                } else {
                    // ì„ íƒ ì˜ì—­ì´ ì—†ìœ¼ë©´ ëì— ì¶”ê°€
                    const wrapper = document.createElement('div');
                    wrapper.className = 'my-4';
                    wrapper.appendChild(imgElement);
                    htmlPreview.appendChild(wrapper);
                }
                syncPreviewToTextarea();
            } else {
                // HTMLëª¨ë“œ: textareaì— ì§ì ‘ ì‚½ì…
                const cursorPos = contentEditor.selectionStart;
                const textBefore = contentEditor.value.substring(0, cursorPos);
                const textAfter = contentEditor.value.substring(cursorPos);
                contentEditor.value = textBefore + imgHtml + textAfter;
                contentEditor.setSelectionRange(cursorPos + imgHtml.length, cursorPos + imgHtml.length);
            }
            
            if (currentPage) {
                saveBtn.disabled = false;
            }
        }

        // ë¯¸ë¦¬ë³´ê¸° í¸ì§‘ ë‚´ìš©ì„ textareaì— ë™ê¸°í™”
        function syncPreviewToTextarea() {
            if (currentMode === 'basic') {
                // í¸ì§‘ëœ HTML ë‚´ìš©ì„ ì •ë¦¬í•´ì„œ textareaì— ì €ì¥
                let cleanHtml = htmlPreview.innerHTML;
                
                // ìë™ìœ¼ë¡œ ì¶”ê°€ëœ Tailwind í´ë˜ìŠ¤ë“¤ì„ ì œê±°í•˜ì—¬ ê¹”ë”í•œ HTMLë¡œ ë³€í™˜
                cleanHtml = cleanHtml.replace(/ class="text-3xl font-bold text-white mb-4"/g, '');
                cleanHtml = cleanHtml.replace(/ class="text-2xl font-semibold text-gray-200 mb-3"/g, '');
                cleanHtml = cleanHtml.replace(/ class="text-xl font-semibold text-gray-300 mb-2"/g, '');
                cleanHtml = cleanHtml.replace(/ class="text-gray-300 mb-4 leading-relaxed"/g, '');
                cleanHtml = cleanHtml.replace(/ class="text-blue-400 hover:text-blue-300 underline"/g, '');
                cleanHtml = cleanHtml.replace(/ class="list-disc list-inside text-gray-300 mb-4 space-y-2"/g, '');
                cleanHtml = cleanHtml.replace(/ class="list-decimal list-inside text-gray-300 mb-4 space-y-2"/g, '');
                cleanHtml = cleanHtml.replace(/ class="text-gray-300"/g, '');
                cleanHtml = cleanHtml.replace(/ class="border-l-4 border-gray-600 pl-4 text-gray-400 italic"/g, '');
                cleanHtml = cleanHtml.replace(/ class="bg-gray-800 text-red-400 px-2 py-1 rounded text-sm font-mono"/g, '');
                cleanHtml = cleanHtml.replace(/ class="bg-gray-800 text-gray-200 p-4 rounded-lg overflow-x-auto mb-4"/g, '');
                
                // ë¹ˆ ì†ì„±ë“¤ ì •ë¦¬
                cleanHtml = cleanHtml.replace(/ class=""/g, '');
                
                contentEditor.value = cleanHtml;
            }
        }

        // ë¶™ì—¬ë„£ê¸° ì²˜ë¦¬
        function handlePasteInPreview(e) {
            e.preventDefault();
            
            // ì¼ë°˜ í…ìŠ¤íŠ¸ë¡œ ë¶™ì—¬ë„£ê¸° (HTML íƒœê·¸ ì œê±°)
            const text = (e.clipboardData || window.clipboardData).getData('text');
            const selection = window.getSelection();
            
            if (selection.rangeCount) {
                const range = selection.getRangeAt(0);
                range.deleteContents();
                
                // ì¤„ë°”ê¿ˆì„ <br>ë¡œ ë³€í™˜
                const formattedText = text.replace(/\n/g, '<br>');
                range.insertNode(range.createContextualFragment(formattedText));
                
                // ì»¤ì„œë¥¼ ëìœ¼ë¡œ ì´ë™
                range.collapse(false);
                selection.removeAllRanges();
                selection.addRange(range);
            }
            
            // textareaì™€ ë™ê¸°í™”
            syncPreviewToTextarea();
        }

        // ê¸°ë³¸ëª¨ë“œì—ì„œ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì²˜ë¦¬
        document.addEventListener('keydown', function(e) {
            if (currentMode === 'basic' && htmlPreview.contentEditable === 'true') {
                // Ctrl+B: ë³¼ë“œ
                if (e.ctrlKey && e.key === 'b') {
                    e.preventDefault();
                    document.execCommand('bold');
                    syncPreviewToTextarea();
                }
                // Ctrl+I: ì´íƒ¤ë¦­
                else if (e.ctrlKey && e.key === 'i') {
                    e.preventDefault();
                    document.execCommand('italic');
                    syncPreviewToTextarea();
                }
                // Ctrl+U: ë°‘ì¤„
                else if (e.ctrlKey && e.key === 'u') {
                    e.preventDefault();
                    document.execCommand('underline');
                    syncPreviewToTextarea();
                }
                // Enter: ë¬¸ë‹¨ ë‚˜ëˆ„ê¸°
                else if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    document.execCommand('insertHTML', false, '<br><br>');
                    syncPreviewToTextarea();
                }
                // Shift+Enter: ì¤„ë°”ê¿ˆ
                else if (e.key === 'Enter' && e.shiftKey) {
                    e.preventDefault();
                    document.execCommand('insertHTML', false, '<br>');
                    syncPreviewToTextarea();
                }
            }
        });

        // ì´ë¯¸ì§€ ì²¨ë¶€ ê¸°ëŠ¥
        imageBtn.addEventListener('click', function() {
            imageUpload.style.display = 'block';
        });

        closeImageBtn.addEventListener('click', function() {
            imageUpload.style.display = 'none';
            imageFile.value = '';
        });

        insertImageBtn.addEventListener('click', async function() {
            const file = imageFile.files[0];
            if (file) {
                imageUpload.style.display = 'none';
                imageFile.value = '';
                await handleImageUpload(file);
            } else {
                showStatusMessage('error', 'ì´ë¯¸ì§€ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
            }
        });

        // íŒŒì¼ ì„ íƒ ì‹œ ìë™ ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)
        imageFile.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                // íŒŒì¼ì´ ì„ íƒë˜ë©´ ë¯¸ë¦¬ë³´ê¸°ë§Œ í‘œì‹œ, ì‹¤ì œ ì—…ë¡œë“œëŠ” "ì‚½ì…" ë²„íŠ¼ í´ë¦­ ì‹œ
                showStatusMessage('success', `${file.name} íŒŒì¼ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤. ì‚½ì… ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.`);
            }
        });

        // ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥
        previewBtn.addEventListener('click', function() {
            const content = contentEditor.value;
            if (!content.trim()) {
                alert('ë¯¸ë¦¬ë³´ê¸°í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ìƒˆ ì°½ìœ¼ë¡œ ì—´ê¸° (ì´ë¦„ ì—†ëŠ” ìƒˆ íƒ­)
            const previewWindow = window.open('', '_blank', 'width=1000,height=700,scrollbars=yes,resizable=yes,toolbar=yes,location=yes');
            
            if (currentMode === 'html') {
                previewWindow.document.write('<!DOCTYPE html>');
                previewWindow.document.write('<html lang="ko">');
                previewWindow.document.write('<head>');
                previewWindow.document.write('<meta charset="UTF-8">');
                previewWindow.document.write('<meta name="viewport" content="width=device-width, initial-scale=1.0">');
                previewWindow.document.write('<title>ë¯¸ë¦¬ë³´ê¸° (HTMLëª¨ë“œ)</title>');
                previewWindow.document.write('<script' + ' src="https://cdn.tailwindcss.com"><' + '/script>');
                previewWindow.document.write('<style>body{font-family:"Malgun Gothic","ë§‘ì€ ê³ ë”•",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;padding:2rem;line-height:1.6;background:#f8fafc}img{max-width:100%;height:auto}.container{max-width:1200px;margin:0 auto}.code-block{background:#1a202c;border-radius:8px;padding:1rem;margin:1rem 0}.code-block code{color:#68d391!important;font-family:"Courier New",monospace}</style>');
                previewWindow.document.write('</head>');
                previewWindow.document.write('<body>');
                previewWindow.document.write('<div class="container">');
                previewWindow.document.write(content);
                previewWindow.document.write('</div>');
                previewWindow.document.write('</body>');
                previewWindow.document.write('</html>');
            } else {
                previewWindow.document.write('<!DOCTYPE html>');
                previewWindow.document.write('<html lang="ko">');
                previewWindow.document.write('<head>');
                previewWindow.document.write('<meta charset="UTF-8">');
                previewWindow.document.write('<meta name="viewport" content="width=device-width, initial-scale=1.0">');
                previewWindow.document.write('<title>ë¯¸ë¦¬ë³´ê¸° (ê¸°ë³¸ëª¨ë“œ)</title>');
                previewWindow.document.write('<style>body{font-family:"Malgun Gothic","ë§‘ì€ ê³ ë”•",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;padding:2rem;line-height:1.6;background:#f8fafc}pre{white-space:pre-wrap;word-wrap:break-word;background:#f1f5f9;padding:1rem;border-radius:8px;border:1px solid #e2e8f0}.container{max-width:1200px;margin:0 auto}</style>');
                previewWindow.document.write('</head>');
                previewWindow.document.write('<body>');
                previewWindow.document.write('<div class="container">');
                previewWindow.document.write('<h2>ê¸°ë³¸ëª¨ë“œ ë¯¸ë¦¬ë³´ê¸°</h2>');
                previewWindow.document.write('<p><small>â€» ì´ ëª¨ë“œì—ì„œëŠ” HTML íƒœê·¸ê°€ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</small></p>');
                previewWindow.document.write('<hr style="margin: 1rem 0;">');
                previewWindow.document.write('<pre>' + content.replace(/</g, '&lt;').replace(/>/g, '&gt;') + '</pre>');
                previewWindow.document.write('</div>');
                previewWindow.document.write('</body>');
                previewWindow.document.write('</html>');
            }
            
            previewWindow.document.close();
        });

        // ì €ì¥ ê¸°ëŠ¥ (disabled ìƒíƒœì—ì„œë„ ë™ì‘)
        saveBtn.addEventListener('click', async function(e) {
            // disabled ìƒíƒœë¼ë©´ ê°•ì œë¡œ í™œì„±í™”
            if (saveBtn.disabled) {
                saveBtn.disabled = false;
                console.log('ì €ì¥ ë²„íŠ¼ ê°•ì œ í™œì„±í™”ë¨');
            }
            
            const content = contentEditor.value;
            console.log('ì €ì¥í•  ë‚´ìš©:', content.substring(0, 100) + '...');
            console.log('í˜„ì¬ í˜ì´ì§€:', currentPage);
            
            if (!currentPage) {
                showStatusMessage('error', 'ì €ì¥í•  í˜ì´ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                console.error('currentPageê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ');
                return;
            }

            if (!content || content.trim().length === 0) {
                showStatusMessage('error', 'ì €ì¥í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                console.error('contentê°€ ë¹„ì–´ìˆìŒ');
                return;
            }

            try {
                saveBtn.disabled = true;
                saveBtn.textContent = 'ì €ì¥ ì¤‘...';
                
                // ë¡œì»¬/ë°°í¬ í™˜ê²½ ëª¨ë‘ API í˜¸ì¶œ
                let shouldCallAPI = true;
                if (shouldCallAPI) {
                    let apiEndpoint = '';
                    if (currentPage === 'API í‚¤ ë°œê¸‰ ê°€ì´ë“œ') {
                        apiEndpoint = '/api/guide/api-key';
                    } else if (currentPage === 'ì‚¬ìš©ë²• ê°€ì´ë“œ') {
                        apiEndpoint = '/api/guide/user-guide';
                    } else {
                        throw new Error('ì•Œ ìˆ˜ ì—†ëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤: ' + currentPage);
                    }

                    console.log('API í˜¸ì¶œ:', `${API_BASE_URL}${apiEndpoint}`);
                    console.log('ì „ì†¡í•  ë°ì´í„° í¬ê¸°:', content.length, 'bytes');

                    const response = await fetch(`${API_BASE_URL}${apiEndpoint}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ content })
                    });

                    console.log('ì„œë²„ ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
                    const result = await response.json();
                    console.log('ì„œë²„ ì‘ë‹µ ê²°ê³¼:', result);

                    if (!response.ok) {
                        throw new Error(result.error || 'ì„œë²„ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                }
                
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ë¡œì»¬/ë°°í¬ í™˜ê²½ ê³µí†µ)
                const saveKey = `adminContent_${currentPage.replace(/[^\w]/g, '_')}`;
                localStorage.setItem(saveKey, content);
                localStorage.setItem('adminContentMode', currentMode);
                localStorage.setItem('adminCurrentPage', currentPage);
                
                // ì„±ê³µ ë©”ì‹œì§€
                if (API_BASE_URL) {
                    showSuccessModal(`âœ… ${currentPage} í˜ì´ì§€ê°€ ë¡œì»¬ ì„œë²„ì™€ ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                } else {
                    showSuccessModal(`âœ… ${currentPage} í˜ì´ì§€ê°€ ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nâš ï¸ ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì— ë°˜ì˜í•˜ë ¤ë©´:\n1. ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ì„¸ìš”\n2. í•´ë‹¹ React ì»´í¬ë„ŒíŠ¸ íŒŒì¼ì„ ì§ì ‘ ìˆ˜ì •í•˜ì„¸ìš”\n3. Git ì»¤ë°‹/í‘¸ì‹œí•˜ì—¬ ë°°í¬í•˜ì„¸ìš”`);
                }
            } catch (error) {
                console.error('ì €ì¥ ì˜¤ë¥˜:', error);
                
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡œì»¬ì—ë§Œ ì €ì¥
                try {
                    const saveKey = `adminContent_${currentPage.replace(/[^\w]/g, '_')}`;
                    localStorage.setItem(saveKey, content);
                    localStorage.setItem('adminContentMode', currentMode);
                    localStorage.setItem('adminCurrentPage', currentPage);
                    showStatusMessage('warning', `âš ï¸ ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜: ${error.message}\n\nì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì— ë°˜ì˜í•˜ë ¤ë©´ React ì»´í¬ë„ŒíŠ¸ íŒŒì¼ì„ ì§ì ‘ ìˆ˜ì •í•˜ê³  ë°°í¬í•´ì£¼ì„¸ìš”.`);
                } catch (localError) {
                    showStatusMessage('error', 'ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            } finally {
                saveBtn.disabled = false;
                saveBtn.textContent = 'ğŸ’¾ ì €ì¥';
            }
        });

        // ì €ì¥ëœ ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadSavedContent() {
            try {
                const savedPage = localStorage.getItem('adminCurrentPage');
                const savedMode = localStorage.getItem('adminContentMode') || 'basic';
                
                if (savedPage) {
                    // ì €ì¥ëœ í˜ì´ì§€ê°€ ìˆìœ¼ë©´ í•´ë‹¹ í˜ì´ì§€ ì„ íƒ
                    pageSelect.value = savedPage;
                    currentPage = savedPage;
                    await loadPageContent(savedPage);
                } else {
                    // ê¸°ë³¸ ëª¨ë“œë¡œ ì €ì¥ëœ ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸°
                    const savedContent = localStorage.getItem(`adminContent_${savedMode}`) || '';
                    contentEditor.value = savedContent;
                }
                
                switchMode(savedMode);
                
                // ê¸°ë³¸ëª¨ë“œì¸ ê²½ìš° ë¯¸ë¦¬ë³´ê¸° ì´ˆê¸°í™”
                if (savedMode === 'basic') {
                    updateHtmlPreview();
                }
                
                if (contentEditor.value) {
                    showStatusMessage('success', 'ì €ì¥ëœ ë‚´ìš©ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
                }
                
                // ì €ì¥ëœ í˜ì´ì§€ê°€ ìˆìœ¼ë©´ ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                if (currentPage && saveBtn) {
                    saveBtn.disabled = false;
                }
            } catch (error) {
                console.error('ì €ì¥ëœ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', error);
            }
        }

        // í˜ì´ì§€ ë‚´ìš©ì„ ì„œë²„ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadPageContent(pageName) {
            const saveKey = `adminContent_${pageName.replace(/[^\w]/g, '_')}`;
            
            try {
                // ë¡œì»¬ í™˜ê²½ì¸ ê²½ìš°ì—ë§Œ API í˜¸ì¶œ
                if (API_BASE_URL) {
                    let apiEndpoint = '';
                    if (pageName === 'API í‚¤ ë°œê¸‰ ê°€ì´ë“œ') {
                        apiEndpoint = '/api/guide/api-key';
                    } else if (pageName === 'ì‚¬ìš©ë²• ê°€ì´ë“œ') {
                        apiEndpoint = '/api/guide/user-guide';
                    } else {
                        throw new Error('ì•Œ ìˆ˜ ì—†ëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.');
                    }

                    const response = await fetch(`${API_BASE_URL}${apiEndpoint}`);
                    const result = await response.json();

                    if (response.ok) {
                        contentEditor.value = result.content;
                        
                        // ë¡œì»¬ì—ë„ ì €ì¥
                        localStorage.setItem(saveKey, result.content);
                        
                        // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                        if (saveBtn) {
                            saveBtn.disabled = false;
                        }
                        
                        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                        updateHtmlPreview();
                        return;
                    } else {
                        throw new Error(result.error || 'í˜ì´ì§€ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                }
                
                // ë°°í¬ í™˜ê²½: localStorageì—ì„œ ì§ì ‘ ë¡œë“œ
                const localContent = localStorage.getItem(saveKey);
                
                if (localContent) {
                    contentEditor.value = localContent;
                    console.log(`âœ… ${pageName} ë¡œì»¬ ì €ì¥ë³¸ ë¡œë“œë¨ (${localContent.length} bytes)`);
                    
                    // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                    if (saveBtn) {
                        saveBtn.disabled = false;
                    }
                    
                    // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                    updateHtmlPreview();
                } else {
                    // ì €ì¥ëœ ë‚´ìš©ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ í…œí”Œë¦¿ ì œê³µ
                    contentEditor.value = getDefaultTemplate(pageName);
                    console.log(`â„¹ï¸ ${pageName} ê¸°ë³¸ í…œí”Œë¦¿ ë¡œë“œë¨`);
                    
                    // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                    if (saveBtn) {
                        saveBtn.disabled = false;
                    }
                    
                    // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                    updateHtmlPreview();
                }
            } catch (error) {
                console.error('í˜ì´ì§€ ë¡œë“œ ì˜¤ë¥˜:', error);
                
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡œì»¬ì—ì„œ ì‹œë„
                const localContent = localStorage.getItem(saveKey);
                
                if (localContent) {
                    contentEditor.value = localContent;
                    showStatusMessage('warning', `âš ï¸ ë¡œì»¬ ì €ì¥ë³¸ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤: ${error.message}`);
                    
                    // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                    if (saveBtn) {
                        saveBtn.disabled = false;
                    }
                    
                    // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                    updateHtmlPreview();
                } else {
                    contentEditor.value = getDefaultTemplate(pageName);
                    showStatusMessage('warning', `ê¸°ë³¸ í…œí”Œë¦¿ì„ ë¡œë“œí–ˆìŠµë‹ˆë‹¤. ì˜¤ë¥˜: ${error.message}`);
                    
                    // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                    if (saveBtn) {
                        saveBtn.disabled = false;
                    }
                    
                    // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                    updateHtmlPreview();
                }
            }
        }

        // ê¸°ë³¸ í…œí”Œë¦¿ ê°€ì ¸ì˜¤ê¸°
        function getDefaultTemplate(pageName) {
            if (pageName === 'API í‚¤ ë°œê¸‰ ê°€ì´ë“œ') {
                return `<!-- ë„¤ë¹„ê²Œì´ì…˜ -->
<nav class="bg-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
        <div class="flex justify-between items-center py-4">
            <h1 class="text-2xl font-bold text-gray-800">ğŸ“ API í‚¤ ë°œê¸‰ ê°€ì´ë“œ</h1>
        </div>
    </div>
</nav>

<!-- ë©”ì¸ ì½˜í…ì¸  -->
<main class="max-w-4xl mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-semibold mb-4">ì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”</h2>
        <p>API í‚¤ ë°œê¸‰ ê°€ì´ë“œ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
    </div>
</main>`;
            } else if (pageName === 'ì‚¬ìš©ë²• ê°€ì´ë“œ') {
                return `<!-- ë„¤ë¹„ê²Œì´ì…˜ -->
<nav class="bg-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
        <div class="flex justify-between items-center py-4">
            <h1 class="text-2xl font-bold text-gray-800">ğŸ“– ì‚¬ìš©ë²• ê°€ì´ë“œ</h1>
        </div>
    </div>
</nav>

<!-- ë©”ì¸ ì½˜í…ì¸  -->
<main class="max-w-4xl mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-semibold mb-4">ì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”</h2>
        <p>ì‚¬ìš©ë²• ê°€ì´ë“œ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
    </div>
</main>`;
            }
            return '<p>í˜ì´ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>';
        }

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function showStatusMessage(type, message) {
            statusMessage.textContent = message;
            statusMessage.className = `status-message status-${type}`;
            statusMessage.style.display = 'block';
            
            setTimeout(() => {
                statusMessage.style.display = 'none';
            }, 3000);
        }

        // ì„±ê³µ ëª¨ë‹¬ í‘œì‹œ
        function showSuccessModal(message) {
            successMessage.textContent = message;
            successModal.classList.add('show');
            
            // 3ì´ˆ í›„ ìë™ìœ¼ë¡œ ëª¨ë‹¬ ë‹«ê¸°
            setTimeout(() => {
                hideSuccessModal();
            }, 3000);
            
            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            successModal.addEventListener('click', function(e) {
                if (e.target === successModal) {
                    hideSuccessModal();
                }
            });
        }

        // ì„±ê³µ ëª¨ë‹¬ ë‹«ê¸°
        function hideSuccessModal() {
            successModal.classList.remove('show');
        }

        // ì„±ê³µ ëª¨ë‹¬ í™•ì¸ ë²„íŠ¼ ì´ë²¤íŠ¸ (ì¦‰ì‹œ ë‹«ê¸°)
        successOkBtn.addEventListener('click', hideSuccessModal);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        window.addEventListener('load', function() {
            console.log('í˜ì´ì§€ ë¡œë“œë¨');
            
            // ì €ì¥ ë²„íŠ¼ ê°•ì œ í™œì„±í™” (DOM ë¡œë“œ í›„)
            setTimeout(function() {
                if (saveBtn) {
                    saveBtn.disabled = false;
                    console.log('DOM ë¡œë“œ í›„ ì €ì¥ ë²„íŠ¼ í™œì„±í™”');
                }
            }, 100);
            
            // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
            if (sessionStorage.getItem('adminLoggedIn') === 'true') {
                isLoggedIn = true;
                showAdminPanel();
                
                // ë¡œê·¸ì¸ëœ ìƒíƒœì—ì„œ ì €ì¥ ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™”
                setTimeout(function() {
                    if (saveBtn) {
                        saveBtn.disabled = false;
                        console.log('ë¡œê·¸ì¸ í›„ ì €ì¥ ë²„íŠ¼ í™œì„±í™”');
                    }
                }, 200);
            }
            
            // ì½˜í…ì¸  ì—ë””í„° ì…ë ¥ ì´ë²¤íŠ¸ ì¶”ê°€
            if (contentEditor) {
                contentEditor.addEventListener('input', function() {
                    if (saveBtn) {
                        saveBtn.disabled = false;
                    }
                });
            }
            
            // í˜ì´ì§€ ì„ íƒ ì‹œ ì €ì¥ ë²„íŠ¼ í™œì„±í™”
            if (pageSelect) {
                pageSelect.addEventListener('change', function() {
                    if (saveBtn && this.value) {
                        saveBtn.disabled = false;
                    }
                });
            }
        });

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        imageUpload.addEventListener('click', function(e) {
            if (e.target === imageUpload) {
                imageUpload.style.display = 'none';
                imageFile.value = '';
            }
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (!isLoggedIn) return;
            
            // Ctrl+S: ì €ì¥
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveBtn.click();
            }
            
            // Ctrl+P: ë¯¸ë¦¬ë³´ê¸°
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                previewBtn.click();
            }
        });
    </script>
</body>
</html>